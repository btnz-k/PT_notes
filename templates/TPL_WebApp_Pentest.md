---
engagement: "<%tp.file.folder(true).split('/')[0]%>"
test_type: WebApp
app_name: <%tp.system.prompt("Application Name")%>
target_url: <%tp.system.prompt("Target URL")%>
start_date: <%tp.date.now("YYYY-MM-DD")%>
end_date: 
assessor: Kal
status: ğŸ”µ Not Started
completion: 0%
tags: [pentest, fedramp, webapp, owasp, <%tp.date.now("YYYY")%>]
---

# ğŸ›¡ï¸ Phase 3: Web Application Penetration Testing
**App Name:** <%tp.system.prompt("Application Name")%>
**Target URL:** <%tp.system.prompt("Target URL")%>
**Date:** <%tp.date.now("YYYY-MM-DD")%>
**Assessor:** Kal

**Test Credentials:**
- **Low User:** <%tp.system.prompt("Low privilege username:password")%>
- **Admin:** <%tp.system.prompt("Admin username:password")%>
- **Unauthenticated:** Verified

---

## ğŸ› ï¸ Tool Setup Verification
- [ ] Burp Suite Professional configured
- [ ] Browser proxy settings configured (127.0.0.1:8080)
- [ ] FoxyProxy installed and configured
- [ ] Wordlists ready: `/usr/share/seclists`
- [ ] Feroxbuster / Gobuster installed
- [ ] SQLMap installed
- [ ] Test accounts validated

---

## ğŸŸ¦ Section 1: Reconnaissance & Configuration
> [!INFO] Focus
> Mapping the application structure, identifying the technology stack, and checking for misconfigurations.

- [ ] **[WEB-REC-01]: Technology Stack & Headers** ^web-rec-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Identify frameworks (React, Angular, PHP) and missing security headers.
	- **Tools:** Wappalyzer, Burp Suite (Target Tab).
	- **Command:**
		```bash
		# Check Headers (HSTS, CSP, X-Frame)
		curl -I -k <URL>
		
		# Directory Brute Force (If allowed)
		feroxbuster -u <URL> -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-REC-01_tech_stack.png]]
		- **Timestamp:** 
		- **Technology Stack:**
		```text
		Framework: 
		Server: 
		Language: 
		Libraries: 
		```
		- **Missing Security Headers:**
		```text
		[list missing headers: HSTS, CSP, X-Frame-Options, etc.]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-REC-02]: SSL/TLS Configuration (SC-8)** ^web-rec-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** FedRAMP requires FIPS-validated ciphers (TLS 1.2+).
	- **Command:**
		```bash
		testssl.sh --fast --severity MEDIUM <URL>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-REC-02_testssl.png]]
		- **Report:** [[<%tp.file.folder(true)%>/_Attachments/testssl_output.html]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste protocol and cipher results]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸ§ Section 2: Authentication & Session Management
> [!WARNING] Focus
> Validating the "Front Door" (IA-2). Testing login logic, MFA, and Session Termination (AC-12).

- [ ] **[WEB-AUTH-01]: MFA Bypass (Critical)** ^web-auth-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** FedRAMP **requires** MFA for privileged access (IA-2(1)). Can you bypass it?
	- **Tests:**
		1. Force browsing to post-auth pages without MFA.
		2. Reusing an MFA token.
		3. Manipulating response status (`403 Forbidden` -> `200 OK`).
	- **Procedure:**
		```text
		1. Login with valid credentials, stop at MFA page
		2. Try to directly navigate to /dashboard or /profile
		3. In Burp Repeater, change 403 response to 200
		4. Try reusing an old MFA code
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-AUTH-01_mfa_bypass.png]]
		- **Timestamp:** 
		- **Test Results:**
		```text
		[describe bypass success or "MFA Enforced"]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-AUTH-02]: Session Attributes (SC-23)** ^web-auth-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Cookies must be `Secure` and `HttpOnly`.
	- **Check:** Inspect cookies in DevTools -> Application -> Cookies.
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-AUTH-02_cookies.png]]
		- **Timestamp:** 
		- **Cookie Attributes:**
		
		| Cookie Name | Secure | HttpOnly | SameSite | Notes |
		|-------------|--------|----------|----------|-------|
		|             |        |          |          |       |
		
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-AUTH-03]: Session Termination / Timeout (AC-12)** ^web-auth-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Does the session expire after inactivity (usually 15-30 mins)?
	- **Test:** Log in, wait 15 mins, try to refresh page.
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-AUTH-03_timeout.png]]
		- **Timestamp:** 
		- **Test Results:**
		```text
		Inactivity timeout: [X minutes]
		Absolute timeout: [X hours]
		Result: [Session timed out correctly / Session remained active]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-AUTH-04]: Username Enumeration / Brute Force** ^web-auth-04
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Do error messages reveal if a user exists? ("User not found" vs "Invalid Creds").
	- **Tool:** Burp Intruder.
	- **Procedure:**
		```text
		1. Capture login request in Burp
		2. Send to Intruder
		3. Test with valid/invalid usernames
		4. Compare response lengths and timing
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-AUTH-04_enumeration.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste distinct error messages or "No enumeration possible"]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸ¥ Section 3: Authorization & Logic (OWASP)
> [!DANGER] Focus
> IDOR, Privilege Escalation, and Access Control (AC-3).

- [ ] **[WEB-LOG-01]: IDOR / BOLA (Insecure Direct Object Reference)** ^web-log-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Can User A see User B's data by changing an ID in the URL/API?
	- **Test:**
		1. Login as User A. Capture a request (e.g., `/api/profile/101`).
		2. Send to Repeater. Change ID to `102` (User B).
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-LOG-01_idor.png]]
		- **Timestamp:** 
		- **Test Details:**
		```text
		User A ID: 
		User B ID: 
		Endpoint tested: 
		Result: [Data leak / Access denied]
		```
		- **Burp Request/Response:**
		```http
		[paste request and response showing data leak]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-LOG-02]: Privilege Escalation (Vertical)** ^web-log-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Can a "Low User" access "Admin" functions?
	- **Test:**
		1. Map Admin URL (e.g., `/admin/users`).
		2. Login as Low User.
		3. Force browse to `/admin/users`.
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-LOG-02_privesc.png]]
		- **Timestamp:** 
		- **Test Results:**
		```text
		Admin endpoint: 
		Low user access: [200 OK (Fail) / 403 Forbidden (Pass)]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-LOG-03]: Mass Assignment (API Focus)** ^web-log-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Can you overwrite read-only fields (e.g., `is_admin`, `role`) during a profile update?
	- **Test:** Add `"is_admin": true` or `"role": "admin"` to a JSON POST request.
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-LOG-03_mass_assignment.png]]
		- **Timestamp:** 
		- **Test Details:**
		```json
		// Original request
		{
		  "username": "testuser",
		  "email": "test@example.com"
		}
		
		// Modified request
		{
		  "username": "testuser",
		  "email": "test@example.com",
		  "is_admin": true,
		  "role": "admin"
		}
		
		// Result: [Success / Rejected]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸ¥ Section 4: Input Validation (Injection)
> [!DANGER] Focus
> SI-10. Validating that the app sanitizes malicious input.

- [ ] **[WEB-INJ-01]: Cross-Site Scripting (XSS)** ^web-inj-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Reflected (URL) or Stored (Database).
	- **Payloads:**
		- `<script>alert(1)</script>`
		- `<img src=x onerror=alert(1)>`
		- `<svg onload=alert(1)>`
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-INJ-01_xss.png]]
		- **Timestamp:** 
		- **Test Results:**
		
		| Location | Type | Payload | Result |
		|----------|------|---------|--------|
		|          |      |         |        |
		
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-INJ-02]: SQL Injection (SQLi)** ^web-inj-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Database manipulation.
	- **Test:**
		- Manual: Add `'` or `' OR 1=1--` to inputs.
		- Tool: `sqlmap -u <URL> --cookie="SESSION=..."` (Check ROE first).
	- **Command:**
		```bash
		# Manual test
		# Add ' to input and look for SQL errors
		
		# SQLMap (if authorized)
		sqlmap -u "http://target.com/page?id=1" --cookie="session=abc123" --batch --risk=3 --level=5
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-INJ-02_sqli.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste SQL error or SQLMap output]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-INJ-03]: Command Injection** ^web-inj-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** OS command execution through user input.
	- **Payloads:**
		- `; whoami`
		- `| whoami`
		- `$(whoami)`
		- `` `whoami` ``
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-INJ-03_command_injection.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste evidence of command execution]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-INJ-04]: File Upload Vulnerabilities** ^web-inj-04
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** If the app accepts files, can you upload an executable (`.php`, `.exe`, `.sh`)?
	- **Test:** Upload a file named `shell.php.png` or edit the Content-Type in Burp.
	- **Procedure:**
		```text
		1. Create test file: <?php system($_GET['cmd']); ?>
		2. Try direct upload
		3. Try extension bypasses: .php.png, .phtml, .php5
		4. Try MIME type manipulation in Burp
		5. Try path traversal: ../../shell.php
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-INJ-04_file_upload.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste screenshot of successful upload or execution]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[WEB-INJ-05]: Server-Side Request Forgery (SSRF)** ^web-inj-05
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Can you make the server request internal resources?
	- **Test Payloads:**
		- `http://127.0.0.1:80`
		- `http://localhost:22`
		- `http://169.254.169.254/latest/meta-data/` (AWS metadata)
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-INJ-05_ssrf.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste response showing internal access]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸª Section 5: API Security
> [!EXAMPLE] Focus
> Testing REST/GraphQL APIs for broken authentication, excessive data exposure, and rate limiting.

- [ ] **[API-01]: Excessive Data Exposure** ^api-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Does the API return more data than necessary?
	- **Test:** Check API responses for sensitive fields not used by the frontend.
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/API-01_data_exposure.png]]
		- **Timestamp:** 
		- **Output:**
		```json
		[paste API response showing excessive data]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[API-02]: Rate Limiting / DoS** ^api-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Are API endpoints protected against abuse?
	- **Test:** Send 100+ rapid requests to an endpoint.
	- **Command:**
		```bash
		# Use Burp Intruder or curl loop
		for i in {1..100}; do curl -s <API_ENDPOINT>; done
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/API-02_rate_limit.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		Requests sent: 100
		Rate limit triggered: [Yes/No]
		Response: [429 Too Many Requests / 200 OK]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[API-03]: GraphQL Introspection** ^api-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Can you query the GraphQL schema to discover hidden queries?
	- **Query:**
		```graphql
		{
		  __schema {
		    types {
		      name
		      fields {
		        name
		      }
		    }
		  }
		}
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/API-03_graphql.png]]
		- **Timestamp:** 
		- **Output:**
		```json
		[paste introspection results]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸª Section 6: Automated Scans
> [!INFO] Focus
> Running the heavy machinery to catch what you missed.

- [ ] **[WEB-AUTO-01]: Burp Suite Professional Scan** ^web-auto-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Authenticated crawl and audit.
	- **Action:** Right-click target -> "Scan" -> "Crawl and Audit".
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-AUTO-01_burp_scan.png]]
		- **Report:** [[<%tp.file.folder(true)%>/_Attachments/Burp_Scan_Report.html]]
		- **Timestamp:** 
		- **Key Findings:**
		```text
		[summarize critical/high findings]
		```
		- **Notes:**

- [ ] **[WEB-AUTO-02]: OWASP ZAP Scan (Alternative)** ^web-auto-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Authenticated scan with OWASP ZAP.
	- **Command:**
		```bash
		zap-cli quick-scan --self-contained --start-options '-config api.key=<API_KEY>' <URL>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/WEB-AUTO-02_zap_scan.png]]
		- **Report:** [[<%tp.file.folder(true)%>/_Attachments/ZAP_Report.html]]
		- **Timestamp:** 
		- **Notes:**

---

## ğŸ”— Related Sections
- [[TPL_External_Pentest|External Testing Phase]]
- [[TPL_Internal_Pentest|Internal Testing Phase]]

---

## ğŸ“Š Findings Summary

```dataview
TABLE
  finding_id as "ID",
  severity as "Severity",
  status as "Status"
FROM "<%tp.file.folder(true)%>"
WHERE contains(file.name, "Finding")
SORT severity DESC
```

---

## ğŸ“¸ Screenshot Naming Convention
**Format:** `[PHASE]_[SECTION-ID]_[BRIEF-DESC]_[TIMESTAMP]`
**Example:** `WEB_LOG-01_idor-test_20260112-1430`
