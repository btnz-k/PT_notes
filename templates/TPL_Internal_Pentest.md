---
engagement: "<%tp.file.folder(true).split('/')[0]%>"
test_type: Internal
start_date: <%tp.date.now("YYYY-MM-DD")%>
end_date: 
assessor: Kal
status: ğŸ”µ Not Started
completion: 0%
tags: [pentest, fedramp, internal, <%tp.date.now("YYYY")%>]
---

# ğŸ›¡ï¸ Phase 2: Internal Network Penetration Testing
**Project:** <%tp.system.prompt("Client/Project Name")%>
**Role:** Insider Threat / Compromised Host (Vector 3)
**Date:** <%tp.date.now("YYYY-MM-DD")%>
**Assessor:** Kal

---

## ğŸ› ï¸ Tool Setup Verification
- [ ] Kali VM accessible on internal network
- [ ] VPN/Jump box connected
- [ ] Tools updated: `sudo apt update && sudo apt upgrade -y`
- [ ] Responder config reviewed: `/etc/responder/Responder.conf`
- [ ] Bloodhound installed: `bloodhound-python`
- [ ] CrackMapExec installed

---

## ğŸŸ¦ Section 1: Internal Reconnaissance & Poisoning
> [!INFO] Focus
> Passive listening and mapping the "soft center" of the network. Identifying broadcast protocols and mapping Active Directory.

- [ ] **[INT-REC-01]: Broadcast Protocol Poisoning (LLMNR/NBT-NS)** ^int-rec-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Check if internal Windows hosts are broadcasting requests that can be poisoned to capture NTLM hashes.
	- **Command:**
		```bash
		# Analyze only (Do not poison yet)
		responder -I <INTERFACE> -A
		
		# Active Poisoning (If Authorized)
		responder -I <INTERFACE> -wrf
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-REC-01_responder.png]]
		- **Timestamp:** 
		- **Captured Hashes:**
		```text
		[paste captured NTLMv2 hashes here]
		```
		- **Cracked Credentials:**
		```text
		[paste hashcat results]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[INT-REC-02]: Internal Network Mapping** ^int-rec-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Identify internal subnets, domain controllers, and file servers.
	- **Command:**
		```bash
		# Ping sweep (Passive-ish)
		nmap -sn -PE <INTERNAL_CIDR> -oA internal_sweep
		
		# SMB Share Enumeration
		crackmapexec smb <CIDR> --shares
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-REC-02_network_map.png]]
		- **Output File:** [[<%tp.file.folder(true)%>/_Attachments/internal_sweep.xml]]
		- **Timestamp:** 
		- **Network Summary:**
		
		| Subnet | Live Hosts | Key Systems | Notes |
		|--------|------------|-------------|-------|
		|        |            |             |       |
		
		- **Accessible SMB Shares:**
		```text
		[paste list of accessible shares]
		```
		- **Notes:**

- [ ] **[INT-REC-03]: Active Directory Enumeration** ^int-rec-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Map the Domain trusts, admins, and users.
	- **Tools:** Bloodhound (ideal) or LDAP domain dump.
	- **Command:**
		```bash
		# Bloodhound collection
		bloodhound-python -c All -u <USER> -p <PASS> -d <DOMAIN> -ns <DC_IP>
		
		# Alternative: ldapdomaindump
		ldapdomaindump -u '<DOMAIN>\<USER>' -p <PASS> <DC_IP>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-REC-03_bloodhound.png]]
		- **Bloodhound Data:** [[<%tp.file.folder(true)%>/_Attachments/bloodhound_data.zip]]
		- **Timestamp:** 
		- **Key Findings:**
		```text
		- Shortest Path to Domain Admin: [describe path]
		- High-Value Targets: [list]
		- Kerberoastable Accounts: [count]
		- AS-REP Roastable: [count]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸ§ Section 2: Authenticated Scanning (Credentialed)
> [!WARNING] Focus
> Deep-dive vulnerability scanning using provided credentials (NIST RA-5).

- [ ] **[INT-VUL-01]: Authenticated Vulnerability Scan** ^int-vul-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** You must perform **credentialed** scanning for Internal systems to verify patch levels (SI-2).
	- **Config:**
		- **Scanner:** Nessus / Rapid7
		- **Credentials:** Domain User / Local Admin (Verify auth success in scan logs).
		- **Policy:** "Credentialed Patch Audit"
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-VUL-01_nessus_auth.png]]
		- **Report:** [[<%tp.file.folder(true)%>/_Attachments/Authenticated_Nessus_Report.html]]
		- **Timestamp:** 
		- **Credential Validation:** 
		```text
		[Verify "Credentialed checks: yes" in output]
		```
		- **Critical/High Findings:**
		```text
		[list critical and high findings]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[INT-VUL-02]: Database Security Check** ^int-vul-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Check for weak SQL configs, default accounts (SA/SA), or unencrypted data at rest.
	- **Command:**
		```bash
		# MS-SQL
		nmap -p 1433 --script ms-sql-info,ms-sql-empty-password,ms-sql-xp-cmdshell <TARGET_IP>
		
		# MySQL
		nmap -p 3306 --script mysql-info,mysql-empty-password <TARGET_IP>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-VUL-02_database.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste nmap SQL script output]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[INT-VUL-03]: Missing Encryption (Internal FIPS)** ^int-vul-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** FedRAMP requires FIPS encryption even *inside* the boundary (SC-8, SC-28).
	- **Check:** Are internal web portals (Intranet) using HTTP? Is Telnet open?
	- **Command:**
		```bash
		# Look for cleartext protocols
		nmap -p 21,23,80,69 -sV <TARGET_SUBNET>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-VUL-03_cleartext.png]]
		- **Timestamp:** 
		- **Cleartext Services Found:**
		
		| IP | Port | Service | Notes |
		|----|------|---------|-------|
		|    |      |         |       |
		
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸ¥ Section 3: Exploitation & Lateral Movement
> [!DANGER] Focus
> Moving from one host to another, escalating privileges, and breaking segmentation (SC-7).

- [ ] **[INT-EXP-01]: Kerberoasting / AS-REP Roasting** ^int-exp-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Request Kerberos tickets for service accounts and crack them offline.
	- **Command:**
		```bash
		# Kerberoasting (Impacket)
		GetUserSPNs.py <DOMAIN>/<USER>:<PASS> -request -dc-ip <DC_IP>
		
		# AS-REP Roasting
		GetNPUsers.py <DOMAIN>/ -usersfile users.txt -dc-ip <DC_IP>
		
		# Crack with Hashcat
		hashcat -m 13100 kerberoast_hashes.txt /usr/share/wordlists/rockyou.txt
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-EXP-01_kerberoast.png]]
		- **Timestamp:** 
		- **Captured Tickets:**
		```text
		[paste Kerberos tickets]
		```
		- **Cracked Passwords:**
		```text
		[paste hashcat results or "No Roastable Accounts"]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[INT-EXP-02]: Lateral Movement (Pass-the-Hash/Password)** ^int-exp-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Can you reuse local admin creds across the fleet? (Validates AC-6 Least Privilege).
	- **Command:**
		```bash
		crackmapexec smb <CIDR> -u <USER> -p <HASH_OR_PASS> --local-auth
		
		# Or with domain creds
		crackmapexec smb <CIDR> -u <USER> -p <PASS> -d <DOMAIN>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-EXP-02_lateral_movement.png]]
		- **Timestamp:** 
		- **Compromised Hosts:**
		
		| IP | Hostname | Access Level | Notes |
		|----|----------|--------------|-------|
		|    |          |              |       |
		
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[INT-EXP-03]: Tenant Separation / Segmentation Check (CRITICAL)** ^int-exp-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Can a compromised host in **Zone A** access the Database in **Zone B** (different tenant/classification)?
	- **Procedure:**
		1. From the compromised host, try to `ping` or `nc -zv` a restricted database IP.
		2. Try to mount a share belonging to another tenant.
	- **Command:**
		```bash
		# Test connectivity to restricted zone
		nc -zv <RESTRICTED_DB_IP> 1433
		ping <RESTRICTED_IP>
		
		# Test SMB access
		smbclient -L //<RESTRICTED_IP> -U <USER>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-EXP-03_segmentation.png]]
		- **Timestamp:** 
		- **Segmentation Test Results:**
		
		| Source Zone | Target Zone | Protocol | Result | Notes |
		|-------------|-------------|----------|--------|-------|
		|             |             |          |        |       |
		
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[INT-EXP-04]: Privilege Escalation (Local)** ^int-exp-04
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Can a standard user become Root/System?
	- **Tools:** WinPEAS / LinPEAS.
	- **Command:**
		```bash
		# Windows
		.\winPEASx64.exe
		
		# Linux
		./linpeas.sh
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/INT-EXP-04_privesc.png]]
		- **Timestamp:** 
		- **Privilege Escalation Vector:**
		```text
		[describe vector: e.g. Unquoted Service Path, SUID binary, misconfigured sudo]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸª Section 4: Container & Kubernetes
> [!EXAMPLE] Context
> **Trigger:** If you land on a host and discover Docker/K8s artifacts, or if scope includes EKS/AKS.
> **Goal:** Container Escape, Cluster Admin Access, and Node Compromise.

- [ ] **[CNT-REC-01]: "Am I in a Container?"** ^cnt-rec-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Determine if your foothold is a VM or a Container.
	- **Command:**
		```bash
		# Check Control Groups
		cat /proc/1/cgroup
		
		# Check env vars
		env | grep -i "KUBERNETES"
		
		# Check for .dockerenv
		ls -la /.dockerenv
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/CNT-REC-01_container_check.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste output confirming container environment]
		```
		- **Notes:**

- [ ] **[CNT-EXP-01]: Dangerous Mounts (The "Docker Sock" Escape)** ^cnt-exp-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Check if the Docker socket is mounted inside the container. If so, you have root on the host.
	- **Command:**
		```bash
		# Look for the socket
		find / -name docker.sock 2>/dev/null
		
		# Exploitation (If found) -> Create a container that mounts the host root "/"
		docker -H unix:///run/docker.sock run -v /:/host -it alpine chroot /host
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/CNT-EXP-01_docker_socket.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste socket discovery or successful chroot]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[CNT-EXP-02]: Kubernetes Service Account Token Abuse** ^cnt-exp-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Every pod has a Service Account (SA) token. Check if it has excessive permissions (RBAC abuse).
	- **Location:** `/var/run/secrets/kubernetes.io/serviceaccount/token`
	- **Command:**
		```bash
		# Check permissions with the token
		kubectl auth can-i --list --token=$(cat /var/run/secrets/kubernetes.io/serviceaccount/token)
		
		# Or use curl
		TOKEN=$(cat /var/run/secrets/kubernetes.io/serviceaccount/token)
		curl -k -H "Authorization: Bearer $TOKEN" https://kubernetes.default.svc/api/v1/namespaces
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/CNT-EXP-02_k8s_token.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste output of 'can-i --list']
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[CNT-EXP-03]: Kubelet API Unauthenticated Access** ^cnt-exp-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** The Kubelet runs on every node (10250/10255). Misconfiguration allows RCE.
	- **Command:**
		```bash
		# Check anonymous access
		curl -k https://<NODE_IP>:10250/pods
		
		# Attempt RCE
		curl -k -XPOST "https://<NODE_IP>:10250/run/<NAMESPACE>/<POD>/<CONTAINER>" -d "cmd=id"
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/CNT-EXP-03_kubelet.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste response from Kubelet API]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[CNT-EXP-04]: Privileged Container Check** ^cnt-exp-04
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Did the developer launch this container with `--privileged`?
	- **Command:**
		```bash
		# Check if we can see host devices
		fdisk -l
		
		# Check capabilities
		capsh --print
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/CNT-EXP-04_privileged.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste screenshot of host drives or capabilities]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[CNT-VUL-01]: Cluster Scanning (Kube-Hunter)** ^cnt-vul-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Automated scan for CIS Benchmark failures.
	- **Command:**
		```bash
		./kube-hunter --remote <CLUSTER_IP>
		
		# Or from inside a pod
		./kube-hunter --pod
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/CNT-VUL-01_kubehunter.png]]
		- **Report:** [[<%tp.file.folder(true)%>/_Attachments/kube-hunter_report.json]]
		- **Timestamp:** 
		- **Notes:**

---

## ğŸ”— Related Sections
- [[TPL_External_Pentest|External Testing Phase]]
- [[TPL_WebApp_Pentest|Web Application Testing Phase]]

---

## ğŸ“Š Findings Summary

```dataview
TABLE
  finding_id as "ID",
  severity as "Severity",
  status as "Status"
FROM "<%tp.file.folder(true)%>"
WHERE contains(file.name, "Finding")
SORT severity DESC
```

---

## ğŸ“¸ Screenshot Naming Convention
**Format:** `[PHASE]_[SECTION-ID]_[BRIEF-DESC]_[TIMESTAMP]`
**Example:** `INT_EXP-02_lateral-movement_20260112-1430`
